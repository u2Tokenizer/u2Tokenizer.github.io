<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Meta tags for social media banners, these should be filled in appropriatly as they are your "business card" -->
  <!-- Replace the content tag with appropriate information -->
  <meta name="description" content="Differentiable Multi-Scale Multi-Modal Tokenizer for Radiology Report Generation">
  <meta property="og:title" content="μ²Tokenizer"/>
  <meta property="og:description" content="Differentiable Multi-Scale Multi-Modal Tokenizer for Radiology Report Generation"/>
  <meta property="og:url" content="https://u2tokenizer.github.io/"/>
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X630-->
  <meta property="og:image" content="static/images/cover_linkedin.png" />
  <meta property="og:image:width" content="1551"/>
  <meta property="og:image:height" content="1200"/>


  <meta name="twitter:title" content="μ²Tokenizer">
  <meta name="twitter:description" content="Differentiable Multi-Scale Multi-Modal Tokenizer for Radiology Report Generation">
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X600-->
  <meta name="twitter:image" content="static/images/cover_linkedin.png">
  <meta name="twitter:card" content="μ²Tokenizer">
  <!-- Keywords for your paper to be indexed by-->
  <meta name="keywords" content="radiology report generation, multimodal large language models">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>μ²Tokenizer</title>
  <link rel="icon" type="image/x-icon" href="static/images/favicon.ico">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
  rel="stylesheet">

  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">

  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/js/all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>
  <!-- <link href="https://cdn.jsdelivr.net/npm/daisyui@4.7.2/dist/full.css" rel="stylesheet" type="text/css" /> -->
  <link href="https://cdn.jsdelivr.net/npm/daisyui@5" rel="stylesheet" type="text/css" />
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
</head>
<body>
<div id="lang-toggle" style="position: fixed; top: 10px; right: 10px; z-index: 1000;">
  <button onclick="window.location.href='index.html'" class="button is-small">EN🇬🇧</button>
  <button onclick="window.location.href='index_zh.html'" class="button is-small">中文🇨🇳</button>
</div>
  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <div class="title-container">
              <img src="static/images/logo.svg" alt="Logo" class="logo-img">
              <h1 class="title is-size-1-desktop is-size-2-tablet is-size-3-mobile publication-title">
                  μ²Tokenizer: 用于放射学报告生成的可微多尺度多模态Tokenizer
              </h1>
            </div>
            <div class="is-size-5 publication-authors">
              <!-- Paper authors -->
              <span class="author-block">
                <a href="https://github.com/Siyou-Li" target="_blank">Siyou Li</a><sup>1</sup>,</span>
                <span class="author-block">
                <a href="https://github.com/qqqqqpy" target="_blank">Pengyao Qin</a><sup>2</sup>,</span>
                <span class="author-block">
                <a href="https://github.com/vincentha766" target="_blank">Huanan Wu</a><sup>3</sup>,</span>
                <span class="author-block">
                <a href="https://sites.google.com/site/ginobilinie/" target="_blank">Dong Nie</a><sup>4</sup>,</span>
                <span class="author-block">
                <a href="https://www.arunthiru.com/" target="_blank">Arun J. Thirunavukarasu</a><sup>5</sup>,</span>
                <span class="author-block">
                <a href="https://www.juntaoyu.com/" target="_blank">Juntao Yu</a><sup>1</sup>,</span>
                <span class="author-block">
                <a href="https://thisislezhang.github.io/" target="_blank">Le Zhang</a><sup>2,6</sup></span>
            </div>
            <div class="text-base text-base-content/80">
                <p><sup>1</sup>电子工程与计算机科学学院</p>
                <p>伦敦玛丽女王大学，英国伦敦</p>
                <p><sup>2</sup>工程与物理科学学院工程学院</p>
                <p>伯明翰大学，英国伯明翰</p>
                <p><sup>3</sup>广东工业大学，中国广东</p>
                <p><sup>4</sup>Meta 公司，美国</p>
                <p><sup>5</sup>Nuffield 临床神经科学系</p>
                <p>牛津大学，英国牛津</p>
                <p><sup>6</sup>威廉·哈维研究所，NIHR 巴茨生物医学研究中心</p>
                <p>伦敦玛丽女王大学，英国伦敦</p>
            </div>
                  <br>
                  <div class="is-size-5 publication-authors">
                    <span class="author-block">
                        <span style="color: #D2232A; font-weight: bold;">MICCAI</span>
                        <span style="color: #2B50A3; font-weight: bold;">2025</span>
                        <br>
                        2025 年 9 月 23 日至 27 日，韩国🇰🇷 Daejeon 见
                    </span>
                  </div>

                  <div class="column has-text-centered">
                    <div class="publication-links">
                         <!-- ArXiv abstract Link -->
                    <span class="link-block">
                    <a href="https://arxiv.org/abs/<ARXIV PAPER ID>" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                        <i class="ai ai-arxiv"></i>
                    </span>
                    <span>arXiv*</span>
                    </a>

                    <span class="link-block">
                      <a href="static/pdfs/μ2_Tokenizer.pdf" target="_blank"
                      class="external-link button is-normal is-rounded is-dark">
                      <span class="icon">
                        <i class="fas fa-file-pdf"></i>
                      </span>
                      <span>paper</span>
                    </a>
                    </span>

                  <!-- Github link -->
                  <span class="link-block">
                    <a href="https://github.com/Siyou-Li/u2Tokenizer" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                  <span class="link-block">
                      <a href="https://huggingface.co/datasets/SiyouLi/u2Qwen3" target="_blank" class="external-link button is-normal is-rounded is-dark">
                          <span class="icon" style="vertical-align: middle; font-size: 30px;"><img src="/static/images/hf.svg"></span>
                          <span style="vertical-align: middle;">μ²Qwen3*</span>
                      </a>
                  </span>
                  <br>
                  <span class="link-block">
                      <a href="https://huggingface.co/datasets/SiyouLi/CT-RATE-Thinking-English" target="_blank" class="external-link button is-normal is-rounded is-dark">
                          <span class="icon" style="vertical-align: middle; font-size: 30px;"><img src="/static/images/hf.svg"></span>
                          <span style="vertical-align: middle;">CT-RATE-Thinking-English*</span>
                      </a>
                  </span>
                  <span class="link-block">
                      <a href="https://huggingface.co/datasets/SiyouLi/CT-RATE-Thinking-Chinese" target="_blank" class="external-link button is-normal is-rounded is-dark">
                          <span class="icon" style="vertical-align: middle; font-size: 30px;"><img src="/static/images/hf.svg"></span>
                          <span style="vertical-align: middle;">CT-RATE-Thinking-Chinese*</span>
                      </a>
                  </span>
                  <br>
                  <span class="link-block">
                      <a href="https://huggingface.co/datasets/SiyouLi/CT-RATE-Chinese" target="_blank" class="external-link button is-normal is-rounded is-dark">
                          <span class="icon" style="vertical-align: middle; font-size: 30px;"><img src="/static/images/hf.svg"></span>
                          <span style="vertical-align: middle;">CT-RATE-Chinese</span>
                      </a>
                  </span>
                  <span class="link-block">
                      <a href="https://huggingface.co/datasets/SiyouLi/CT-RATE-Mini" target="_blank" class="external-link button is-normal is-rounded is-dark">
                          <span class="icon" style="vertical-align: middle; font-size: 30px;"><img src="/static/images/hf.svg"></span>
                          <span style="vertical-align: middle;">CT-RATE-Mini</span>
                      </a>
                  </span>
                  <p class="italic-text">* 即将上线</p>
                </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<!-- Demo section -->
<section class="section hero is-small">
  <div class="hero-body">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-full">
        <div class="content text-left">
            <div class="w-full h-[360px] border-solid border-base-300 rounded-lg">
              <canvas id="gl"></canvas>
            </div>
            <div class="relative rounded-l-none">
              <div class="tabs tabs-lift">
                <input type="radio" name="my_tabs_1" class="tab" aria-label="Report Generation" checked="checked" />
                <div id="content-mrg" class="tab-content bg-base-100 border-base-300 md:p-6 overflow-y-auto"
                  style="max-height: 600px;">
                  <div class="chat chat-end">
                    <div class="chat-bubble bg-base-200 text-black">Describe this scan's findings.</div>
                  </div>
                  <div class="chat chat-start">
                    <div class="chat-bubble bg-base-200 text-black">
                      <div tabindex="0" class="collapse">
                        <input type="checkbox" />
                        <div class="collapse-title font-semibold">Thinking</div>
                        <div class="collapse-content text-sm">
                            The clinical significance of unclear intestinal structures and thickened intestinal walls in the lower right abdomen following surgery must be interpreted in the context of potential postoperative complications. These findings raise concern for inflammation, infection, or ischemia. Adhesions from prior surgery can lead to anatomical distortion, making bowel loops difficult to delineate. The presence of both air and fluid within the bowel, along with perienteric air, increases suspicion for an anastomotic leak or a contained perforation. Striated and patchy densities in the surrounding region may represent inflammatory stranding or localized fluid collections. While postoperative edema may explain some of these findings, the combination of wall thickening, air, and fluid is more indicative of an infectious or perforative process rather than simple post-surgical healing. No abnormalities are seen in other organs, reinforcing a focus on bowel integrity. The patchy and striated shadows observed around the intestines further support the presence of localized inflammation or infection. Striated opacities typically reflect edema or inflammatory infiltration of perienteric fat, commonly seen in conditions such as diverticulitis, appendicitis, or postoperative abscesses. Patchy gas collections adjacent to thickened bowel walls may indicate a minor perforation or infection with gas-forming organisms such as *E. coli* or *Clostridium*. The lack of widespread peritoneal involvement or significant lymphadenopathy makes diffuse peritonitis or metastatic disease less likely. The thickened ileocecal wall and fluid-gas levels in the intestine suggest a focal process such as a localized infection, enterocolitis, or postoperative complication like an anastomotic leak or adhesive ileus with secondary inflammation. Localized air accumulation in the lower right abdominal wall post-surgery is best interpreted in the context of thickened intestinal walls and perienteric air. The ileocecal wall thickening supports a localized inflammatory process. Generalized peritoneal free air is absent, and other organs appear normal, which excludes visceral perforation as a primary cause. This pattern is most consistent with a localized infection or abscess involving gas-forming pathogens, potentially due to surgical contamination or anastomotic leakage. The air appears to be confined, indicating a contained infection rather than systemic sepsis or diffuse peritonitis. The presence of both air and liquid within the intestines postoperatively raises the possibility of impaired motility (ileus) or mechanical obstruction. However, the radiographic findings of patchy perienteric air and wall thickening suggest that localized inflammation or leakage may be contributing to bowel dysfunction. While ileus alone may present with dilated loops of bowel, the focal nature of these findings supports a localized process such as minor anastomotic dehiscence leading to inflammation and secondary ileus. Obstruction is less likely without a clear transition point or marked dilation. The smooth liver surface and uniform parenchymal density indicate no structural abnormalities, such as cirrhosis, focal masses, or metastatic lesions. The absence of heterogeneous attenuation changes supports normal hepatic parenchyma without evidence of infection, hemorrhage, or tumor infiltration. The gallbladder's normal size, shape, and the lack of bile duct dilation suggest no involvement of the biliary system. This excludes biliary obstruction, cholecystitis, or bile leak as sources of the observed findings, which are instead confined to the intestinal structures in the lower right abdomen. The lack of abnormalities in the spleen, pancreas, and kidneys indicates that the disease process is localized rather than systemic. Conditions such as vasculitis, widespread infection, or metastatic disease typically involve multiple organs, but none of these are present here. This supports a diagnosis limited to the surgical site, such as infection, localized inflammation, or mechanical complications. The absence of enlarged retroperitoneal lymph nodes further narrows the differential to a localized process. Systemic etiologies such as lymphoma, tuberculosis, or sarcoidosis are less likely. However, localized inflammatory conditions like Crohn’s disease or postoperative infection remain possible. Clinical correlation with symptoms and lab values is essential. Perienteric air and wall thickening are not typical of simple postoperative changes and are more indicative of a visceral leak. Anastomotic dehiscence is the most plausible explanation for these findings, especially when combined with subcutaneous emphysema. Adhesions or abscess formation are less likely without signs of obstruction or fluid collections with air-fluid levels. The fistula in the left lower abdominal wall is likely **colocutaneous**, given its anatomical location and the presence of fluid accumulation and a drainage tube. Possible origins include chronic colonic inflammation (such as from Crohn’s disease or diverticulitis) or surgical complications such as colostomy breakdown or wound infection. There is no evidence of bladder involvement, ruling out vesicocutaneous fistula. The bladder appears normal in contour and density, indicating that the urinary system is not involved in the current pathology. This supports the conclusion that the fluid accumulation and fistula are not related to urinary leakage or obstruction. The drainage tube and fistula are likely interrelated. The tube may have been placed to manage fluid from the fistula, or the fistula may have developed in response to the tube’s presence, possibly due to irritation or infection. Their coexistence in the same anatomical region indicates a clinical or pathological connection. The fluid accumulation in the abdominopelvic cavity is likely connected to the fistula. If the fistula communicates with the bowel or another hollow viscus, enteric contents may be leakinginto the peritoneal space, leading to inflammation and fluid exudation. The drainage tube may be attempting to manage this leakage, but ongoing communication through the fistula may sustain the fluid collection. These findings raise concern for potential complications such as infection, inflammation, or ongoing leakage. The presence of a fistula increases the risk of sepsis and skin breakdown. While imaging does not directly show signs of acute infection (e.g., rim-enhancing fluid or purulent collections), the clinical context and presence of drainage and fluid accumulation suggest an underlying complicated process. Bowel obstruction is less likely unless there is involvement of adjacent loops, which is not explicitly noted. Collectively, these findings suggest a complex postoperative scenario that may involve anastomotic leakage or localized infection. Management should include close monitoring, possible infectious disease consultation, surgical review, and potential interventional radiology involvement to assess and manage the fluid and fistula.
                        </div>
                      </div>
                      CT imaging reveals a distended stomach with 12 mm, heterogeneously enhancing mucosal thickening in the body and antrum; mild ileocecal wall thickening without abnormal enhancement; a normally proportioned liver containing multiple non-enhancing low-density cysts (largest 14 × 20 mm in segment VIII), an 8 × 16 mm patchy low-density lesion in segment IV showing slight progressive enhancement, and a tiny calcified focus in segment VI; non-dilated intra- and extra-hepatic bile ducts; unremarkable gallbladder, spleen, pancreas and retroperitoneal nodes; and normal-shaped kidneys with clear perirenal fat and multiple non-enhancing cysts (largest 13 × 17 mm in the right mid-pole) without pelvicalyceal or ureteric dilatation.
                    </div>
                  </div>
                </div>

                <input type="radio" name="my_tabs_1" class="tab" aria-label="QA(English)" />
                <div id="content-en" class="tab-content bg-base-100 border-base-300 md:p-6 overflow-y-auto" style="max-height: 600px;">
                    <div class="chat chat-end">
                        <div class="chat-bubble bg-base-200 text-black">What does the thickened gastric mucosa (12mm) with uneven and obvious enhancement in the stomach suggest? </div>
                    </div>
                    <div class="chat chat-start">
                        <div class="chat-bubble bg-base-200 text-black">
                            <div tabindex="0" class="collapse">
                                <input type="checkbox" />
                                <div class="collapse-title font-semibold">Thinking</div>
                                <div class="collapse-content text-sm">
                                    The gastric mucosa thickens to 12mm, exceeding normal physiological limits (typically small 5-10mm). The appearance shows uneven and obvious enhancement, suggesting an infiltrative process disrupting the gastric wall's vascular architecture. Heterogeneous enhancement is often associated with neoplastic or inflammatory conditions. Malignancy (e.g., gastric adenocarcinoma) is a key concern due to the irregular enhancement pattern, which reflects disorganized tumor vascularity and necrosis. Lymphoma or severe gastritis could also present similarly, but the lack of systemic findings (e.g., lymphadenopathy) and the focal nature favor a primary malignant process. The absence of other acute findings (e.g., ulcerations) further raises suspicion for malignancy.
                                </div>
                            </div>
                            The thickened gastric mucosa with uneven, obvious enhancement raises concern for gastric malignancy, particularly adenocarcinoma, due to the irregular vascular pattern and significant wall thickening. Differential diagnoses include lymphoma or severe inflammatory gastritis, but malignancy is the most critical consideration.
                        </div>
                    </div>
                </div>

                <input type="radio" name="my_tabs_1" class="tab" aria-label="QA(Chinese)" />
                <div id="content-zh" class="tab-content bg-base-100 border-base-300 md:p-6 overflow-y-auto" style="max-height: 600px;">
                    <div class="chat chat-end">
                        <div class="chat-bubble bg-base-200 text-black">肾脏有哪些异常，特别是在位置、形状和囊肿病变方面？</div>
                    </div>
                    <div class="chat chat-start">
                        <div class="chat-bubble bg-base-200 text-black">
                            <div tabindex="0" class="collapse">
                                <input type="checkbox" />
                                <div class="collapse-title font-semibold">Thinking</div>
                                <div class="collapse-content text-sm">
                                    在评估肾脏时，我首先观察其位置，注意到左肾“位置略低”，提示存在位置异常。其次，“双肾形态正常”，说明未见结构扭曲或畸形。关于囊性病变，可见“双肾多发低密度囊性病变”，其中右肾中极最大病灶约 13 mm × 17 mm。上述病灶未见异常强化，提示为良性囊性改变。此外，双侧肾盂、肾盏及输尿管均未见扩张，可排除梗阻性病变。
                                </div>
                            </div>
                            双肾位置异常，左肾略低。双肾形态正常。双肾内见多发低密度囊性病灶，其中右肾中极可见较大囊性病灶，大小约 13 mm × 17 mm；上述病灶均未见异常强化。未见肾盂、肾盏或输尿管扩张。
                        </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End demo section -->

<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-full">
        <h2 class="title is-3">概述</h2>
        <div class="content has-text-justified">
          <p>自动生成放射学报告（RRG）是一项前景广阔的人工智能应用，其目标是从 CT 等医学影像生成详细的文本报告，从而辅助放射科医生。然而，这一任务面临两个主要难题：</p>
            <ol>
            <li><strong>复杂的信息提取</strong>：在庞大且分辨率多变的影像数据中高效提取所有相关诊断信息需要大量计算资源，且容易出现信息缺失。</li>
            <li><strong>主观性评估</strong>：传统文本生成指标往往无法准确衡量报告的临床准确性及语义意义。</li>
            </ol>
            <p>为了解决这些问题，我们提出了 <strong>μ²LLM</strong>，一种多尺度多模态的大型语言模型。其核心为创新的 <strong>μ² Tokenizer</strong> 中间层，能够智能地将 CT 图像的视觉特征与文本信息融合。该模型在专用医学报告评估指标 GREEN 的指导下，通过直接偏好优化（DPO）进一步提升，使生成的报告符合专家标准。</p>
            <p>在四个大规模 CT 数据集上的实验结果表明，μ²LLM 的性能优于现有方法，即使训练数据有限，也能生成高质量的放射学报告。</p>
            <img src="static/images/cover.svg" alt="Weight distance correlation" class="blend-img-background center-image responsive-img">
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section hero is-small">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column is-full">
        <div class="content">
          <h2 class="title is-3">主要贡献</h2>
          <div class="rows">
            <ol>
            <li><strong>μ²LLM 框架</strong>：我们提出一种新的多模态大型语言模型，通过引入提示问题，能够高效地保留医学图像中的关键细节。</li>
            <li><strong>μ² Tokenizer 层</strong>：该框架的核心为 μ² Tokenizer，利用多层次注意力和多尺度聚合对视觉和文本特征进行精炼与融合，在保持计算效率的同时最大化语义对应。</li>
            <li><strong>DPO 增强训练</strong>：我们采用直接偏好优化（DPO）使模型输出与专家认可的临床准确性保持一致。偏好数据由基于 LLM 的指标 GREEN 构建，能够可靠地评估放射学报告的临床准确性。</li>
            <li><strong>先进的性能</strong>：尽管模型参数量仅为 1B，但在多个数据集上仍显著超越 7B 至 14B 的基线模型，显示了方法的有效性。</li>
            </ol>
          </div>
          <br>
            <br>
            <img src="/static/images/dpo.svg" alt="Weight distance correlation" class="blend-img-background center-image responsive-img">
            <br>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-full">
        <h2 class="title is-3">模型架构</h2>
        <div class="content has-text-justified">
        <p>μ²LLM 框架采用 3D Vision Transformer（ViT3D）作为图像编码器，并结合大型语言模型生成报告。关键创新在于 <strong>μ² Tokenizer</strong>，它充当两者之间的桥梁。</p>
        <p><strong>Overall Pipeline (μ²LLM)</strong>
        <br>
        <br>
        <img src="/static/images/u2llm.svg" alt="Weight distance correlation" class="blend-img-background center-image responsive-img">
        <br>
        <em>Fig. 1: Overview of our proposed µ²LLM model that is centered with the μ² Tokenizer layer for high quality RRG task.</em> </p>
        <ol>
        <li><strong>输入</strong>：一份 3D CT 扫描及相关文本问题（例如：“根据腹部检查结果给出诊断？”）。</li>
        <li><strong>图像编码器 (ViT3D)</strong>：将 CT 扫描分割成多帧以避免降采样导致的信息丢失，ViT3D 对这些帧进行处理以提取视觉标记序列。</li>
        <li><strong>μ² Tokenizer</strong>：该层接收编码器得到的视觉标记与分词后的问题，利用多尺度注意力机制融合两种模态，生成紧凑且信息丰富的嵌入表示。</li>
        <li><strong>LLM</strong>：最终的图像嵌入与原始问题一起输入到 LLM，生成详细的放射学报告。</li>
        </ol>
        <h3 id="the-tokenizer-module">The μ² Tokenizer Module</h3>
        <p>μ² Tokenizer 在 Linear Video Tokenizer (LinVT) 的基础上进行改进，引入了三项关键提升：</p>
        <ul>
        <li><strong>相对位置编码 (RPE)</strong>：在注意力机制中采用相对位置编码而非绝对位置，有助于模型更好地捕捉 3D 扫描不同区域之间的局部关系，对于识别解剖结构尤为重要。</li>
        <li><strong>可微标记选择 (DTS)</strong>：传统的“硬” top-k 选择容易造成信息损失并减慢优化速度，我们采用完全可微的“软”选择，通过对所有标记加权求和来保留更多信息，并使梯度能够回传至所有视觉标记，从而提高训练稳定性。</li>
        <li><strong>动态多尺度池化 (DMTP)</strong>：不再使用固定的池化核大小，网络能够根据输入学习如何权衡和选择最合适的池化策略，使特征提取更加自适应和高效。</li>
        </ul>
        <hr>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section hero is-small">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
        <div class="column is-full">
        <div class="content">
          <h2 class="title is-3">Prompt 工程</h2>
          <br>
          <img src="/static/images/prompt_engineering_d.svg" alt="Weight distance correlation" class="blend-img-background center-image responsive-img">
          <br>
          <p>在我们的工作流程中，我们应用了三种及时工程技术 -  “CT报告重写”，“CT报告推理合成”和“CT报告翻译” - 这里特别强调“CT报告推理合成”。附录A中列出了具体过程和涉及的提示。</p>
          <p>我们的流水线将每份 CT 放射学报告转换为两种互补的监督信号：一组具有临床意义的视觉-问答（VQA）对，以及一条连贯的、由模型生成的思维链，解读报告的发现。一套轻量级控制器编排由五个 LLM 驱动的阶段，确保问题、答案和推理痕迹既忠实于源文本，又涵盖广泛的放射学关注点。</p>
          <p>首先，问题生成阶段 读取完整报告（影像发现和印象），并让 LLM 提出多样化的自然语言问题——这些问题是放射科医师、培训生或下游 AI 系统在阅读报告后可能提出的。提示中的约束确保覆盖病灶属性、解剖定位、诊断确定性及随访建议，为每份检查构建丰富的探询空间。</p>
          <p>其次，将每个问题与原始报告配对，并在“逐步思考”的指令下重新提交给 LLM。模型必须大声“思考”，在给出简明答案之前引用报告片段或公认的影像学先验。由此产生的问题-答案-原始推理三元组，在一次前向过程中同时捕获知识与其论证。</p>
          <p>第三，自动化的审查器会重新审查每个三元组。第二次 LLM 评估检查答案与报告之间的事实一致性；启发式规则剔除非英语或空洞的思维链；领域特定规则排除生理病理矛盾（例如首次发现气胸却声称其“好转”）。只有通过全部三重过滤的三元组才能保留。</p>
          <p>第四，通过推理精炼，保留下来的思维链被 LLM 压缩成简短且带有证据链接的段落，其引用指向报告的具体行。冗余内容被删除，含糊措辞被弱化，并在适当情况下插入概率性修饰词，以校准地反映临床不确定性。</p>
          <p>最后，流水线将所有精炼后的推理融合成单一的、结构化的“报告思维”叙事。LLM 合并重叠的论据，按解剖顺序组织推理，并划分为 发现依据、印象依据 和 随访依据 三个部分。由此产生的完整数据点包含 CT 影像、其 VQA 对（含答案）以及一份为每个关键信息点提供放射学证据支撑的连贯解释，使多模态模型能够在回答问题的同时给出可信的理由。</p>
          
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-full">
        <h2 class="title is-3">结果</h2>
        <div class="content">
          <p>我们的模型在多个基准数据集上与其他高性能的大模型进行评测，使用了传统指标（ROUGE、METEOR、BERTScore）以及衡量临床准确性的先进LLM指标<strong>GREEN</strong>。</p>
        <h3 id="performance-comparison">性能对比</h3>
        <p>μ²LLM 在所有数据集上都取得了最先进的结果，显著超过了像 LaMed-Llama-2-7B 和 RadFM-14B 这样的更大模型。利用基于 GREEN 分数微调的 DPO 进一步提升了性能，平均带来<strong>20% 的提升</strong>。</p>
        <p><strong>表 1：不同数据集的性能对比</strong></p>
        <table>
        <thead>
        <tr>
        <th style="text-align:left">数据集</th>
        <th style="text-align:left">模型</th>
        <th style="text-align:center">ROUGE-1</th>
        <th style="text-align:center">GREEN</th>
        <th style="text-align:center">METEOR</th>
        <th style="text-align:center">BERTScore</th>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td style="text-align:left"></td>
        <td style="text-align:left">LaMed-Phi-3-4B</td>
        <td style="text-align:center">0.136</td>
        <td style="text-align:center">0.011</td>
        <td style="text-align:center">0.058</td>
        <td style="text-align:center">0.807</td>
        </tr>
        <tr>
        <td style="text-align:left"></td>
        <td style="text-align:left">LaMed-Llama-2-7B</td>
        <td style="text-align:center">0.139</td>
        <td style="text-align:center">0.009</td>
        <td style="text-align:center">0.060</td>
        <td style="text-align:center">0.810</td>
        </tr>
        <tr>
        <td style="text-align:left"><strong>Abdomen Atlas</strong></td>
        <td style="text-align:left">RadFM-14B</td>
        <td style="text-align:center">0.037</td>
        <td style="text-align:center">0.000</td>
        <td style="text-align:center">0.013</td>
        <td style="text-align:center">0.794</td>
        </tr>
        <tr>
        <td style="text-align:left"></td>
        <td style="text-align:left">RadGPT-N</td>
        <td style="text-align:center">0.247</td>
        <td style="text-align:center"></td>
        <td style="text-align:center">0.112</td>
        <td style="text-align:center"></td>
        </tr>
        <tr>
        <td style="text-align:left"></td>
        <td style="text-align:left"><strong>μ²LLM-1B (SFT)</strong></td>
        <td style="text-align:center"><strong>0.529</strong></td>
        <td style="text-align:center"><strong>0.281</strong></td>
        <td style="text-align:center"><strong>0.295</strong></td>
        <td style="text-align:center"><strong>0.891</strong></td>
        </tr>
        <tr>
        <td style="text-align:left"></td>
        <td style="text-align:left"><strong>μ²LLM-1B (SFT&ampDPO)</strong></td>
        <td style="text-align:center"><strong>0.567</strong></td>
        <td style="text-align:center"><strong>0.346</strong></td>
        <td style="text-align:center"><strong>0.319</strong></td>
        <td style="text-align:center"><strong>0.895</strong></td>
        </tr>
        <tr>
        <td style="text-align:left"></td>
        <td style="text-align:left">LaMed-Phi-3-4B</td>
        <td style="text-align:center">0.130</td>
        <td style="text-align:center">0.002</td>
        <td style="text-align:center">0.050</td>
        <td style="text-align:center">0.814</td>
        </tr>
        <tr>
        <td style="text-align:left"></td>
        <td style="text-align:left">LaMed-Llama-2-7B</td>
        <td style="text-align:center">0.103</td>
        <td style="text-align:center">0.001</td>
        <td style="text-align:center">0.048</td>
        <td style="text-align:center">0.815</td>
        </tr>
        <tr>
        <td style="text-align:left"><strong>CT-Rate</strong></td>
        <td style="text-align:left">RadFM-14B</td>
        <td style="text-align:center">0.054</td>
        <td style="text-align:center">0.014</td>
        <td style="text-align:center">0.017</td>
        <td style="text-align:center">0.812</td>
        </tr>
        <tr>
        <td style="text-align:left"></td>
        <td style="text-align:left">CT-CHAT-8B</td>
        <td style="text-align:center">0.294</td>
        <td style="text-align:center">0.113</td>
        <td style="text-align:center">0.221</td>
        <td style="text-align:center">0.815</td>
        </tr>
        <tr>
        <td style="text-align:left"></td>
        <td style="text-align:left"><strong>μ²LLM-1B (SFT)</strong></td>
        <td style="text-align:center"><strong>0.517</strong></td>
        <td style="text-align:center"><strong>0.384</strong></td>
        <td style="text-align:center"><strong>0.330</strong></td>
        <td style="text-align:center"><strong>0.879</strong></td>
        </tr>
        <tr>
        <td style="text-align:left"></td>
        <td style="text-align:left"><strong>μ²LLM-1B (SFT&ampDPO)</strong></td>
        <td style="text-align:center"><strong>0.539</strong></td>
        <td style="text-align:center"><strong>0.429</strong></td>
        <td style="text-align:center"><strong>0.359</strong></td>
        <td style="text-align:center"><strong>0.890</strong></td>
        </tr>
        <tr>
        <td style="text-align:left"></td>
        <td style="text-align:left">LaMed-Phi-3-4B</td>
        <td style="text-align:center">0.126</td>
        <td style="text-align:center">0.009</td>
        <td style="text-align:center">0.047</td>
        <td style="text-align:center">0.821</td>
        </tr>
        <tr>
        <td style="text-align:left"></td>
        <td style="text-align:left">LaMed-Llama-2-7B</td>
        <td style="text-align:center">0.163</td>
        <td style="text-align:center">0.009</td>
        <td style="text-align:center">0.065</td>
        <td style="text-align:center">0.823</td>
        </tr>
        <tr>
        <td style="text-align:left"><strong>AMOS-MM</strong></td>
        <td style="text-align:left">RadFM-14B</td>
        <td style="text-align:center">0.046</td>
        <td style="text-align:center">0.001</td>
        <td style="text-align:center">0.015</td>
        <td style="text-align:center">0.812</td>
        </tr>
        <tr>
        <td style="text-align:left"></td>
        <td style="text-align:left"><strong>μ²LLM-1B (SFT)</strong></td>
        <td style="text-align:center"><strong>0.421</strong></td>
        <td style="text-align:center"><strong>0.339</strong></td>
        <td style="text-align:center"><strong>0.249</strong></td>
        <td style="text-align:center"><strong>0.881</strong></td>
        </tr>
        <tr>
        <td style="text-align:left"></td>
        <td style="text-align:left"><strong>μ²LLM-1B (SFT&ampDPO)</strong></td>
        <td style="text-align:center"><strong>0.459</strong></td>
        <td style="text-align:center"><strong>0.400</strong></td>
        <td style="text-align:center"><strong>0.876</strong></td>
        <td style="text-align:center"><strong>0.881</strong></td>
        </tr>
        </tbody>
        </table>
        <h3 id="ablation-study">消融实验</h3>
        <p>消融实验表明 μ² Tokenizer 的各个组件均对模型性能有正向贡献，其中可微分的令牌选择（DTS）带来了最显著的提升，使 GREEN 分数最高提高了 0.2。</p>
        <p><strong>表 2：μ²Tokenizer 组件的消融实验</strong></p>
        <table>
        <thead>
        <tr>
        <th style="text-align:left">模型</th>
        <th style="text-align:center">BLEU</th>
        <th style="text-align:center">ROUGE-1</th>
        <th style="text-align:center">GREEN</th>
        <th style="text-align:center">METEOR</th>
        <th style="text-align:center">BERTScore</th>
        </tr>
        </thead>
        <tbody>
        <tr>
        <td style="text-align:left">Baseline</td>
        <td style="text-align:center">0.190</td>
        <td style="text-align:center">0.405</td>
        <td style="text-align:center">0.204</td>
        <td style="text-align:center">0.210</td>
        <td style="text-align:center">0.864</td>
        </tr>
        <tr>
        <td style="text-align:left">+RPE</td>
        <td style="text-align:center">0.281</td>
        <td style="text-align:center">0.421</td>
        <td style="text-align:center">0.277</td>
        <td style="text-align:center">0.236</td>
        <td style="text-align:center">0.880</td>
        </tr>
        <tr>
        <td style="text-align:left">+DTS</td>
        <td style="text-align:center">0.271</td>
        <td style="text-align:center">0.411</td>
        <td style="text-align:center">0.299</td>
        <td style="text-align:center">0.240</td>
        <td style="text-align:center">0.888</td>
        </tr>
        <tr>
        <td style="text-align:left">+DMTP</td>
        <td style="text-align:center">0.254</td>
        <td style="text-align:center">0.401</td>
        <td style="text-align:center">0.233</td>
        <td style="text-align:center">0.220</td>
        <td style="text-align:center">0.874</td>
        </tr>
        <tr>
        <td style="text-align:left"><strong>μ²LLM-1B (SFT)</strong></td>
        <td style="text-align:center">0.279</td>
        <td style="text-align:center">0.421</td>
        <td style="text-align:center">0.339</td>
        <td style="text-align:center">0.249</td>
        <td style="text-align:center">0.881</td>
        </tr>
        <tr>
        <td style="text-align:left"><strong>μ²LLM-1B (SFT&ampDPO)</strong></td>
        <td style="text-align:center"><strong>0.336</strong></td>
        <td style="text-align:center"><strong>0.459</strong></td>
        <td style="text-align:center"><strong>0.400</strong></td>
        <td style="text-align:center"><strong>0.876</strong></td>
        <td style="text-align:center"><strong>0.881</strong></td>
        </tr>
        </tbody>
        </table>
        <hr>
        </div>
      </div>
    </div>
  </div>
</section>

<!--BibTex citation -->
  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre>
        <code>
            @misc{li2025mu2tokenizerdifferentiablemultiscalemultimodal,
                  title={${\mu}^2$Tokenizer: Differentiable Multi-Scale Multi-Modal Tokenizer for Radiology Report Generation}, 
                  author={Siyou Li and Pengyao Qin and Huanan Wu and Dong Nie and Arun J. Thirunavukarasu and Juntao Yu and Le Zhang},
                  year={2025},
                  eprint={2507.00316},
                  archivePrefix={arXiv},
                  primaryClass={cs.LG},
                  url={https://arxiv.org/abs/2507.00316}, 
            }
        </code>
    </pre>
    </div>
</section>
<!--End BibTex citation -->

<!-- Statcounter tracking code -->
  
<!-- You can add a tracker to track page visits by creating an account at statcounter.com -->

    <!-- End of Statcounter Code -->
  </body>
  <script type="module" async>
      import { Niivue } from "https://unpkg.com/@niivue/niivue@0.57.0/dist/index.js"
      var volumeList = [
          { url: "https://img.staticstuff.top/amos_5001.nii.gz" },
      ];
      var nv = new Niivue({ isResizeCanvas: true, backColor: [1, 1, 1, 1] });
      nv.setSliceType(nv.sliceTypeMultiplanar);
      nv.setMultiplanarLayout(0);

      // Define a custom layout
      const rowLayout = [
        // Sagittal view
        { sliceType: nv.sliceTypeSagittal, position: [0, 0, 0.25, 1] },
        // Coronal view  
        { sliceType: nv.sliceTypeCoronal, position: [0.25, 0, 0.25, 1] },
        // Axial view
        { sliceType: nv.sliceTypeAxial, position: [0.5, 0, 0.25, 1] },
        // volume render view
        { sliceType: nv.sliceTypeRender, position: [0.75, 0, 0.25, 1] }
      ];

      await nv.attachTo("gl");
      await nv.loadVolumes(volumeList);

      function updateLayout() {
        // get window width
        const windowWidth = window.innerWidth;
        nv.clearCustomLayout();
        if (windowWidth < 768) {
          nv.setMultiplanarLayout(2);
        } else {
          // nv.setMultiplanarLayout(3);
          nv.setCustomLayout(rowLayout);
        }
      }

      window.addEventListener("resize", updateLayout);
      updateLayout();
  </script>
  </html>
